<header class="app-header">
    <div class="header-content">

        <div class="brand" routerLink="/home">
            <img src="assets/logo.png" alt="Logo SmartDesk" class="brand-logo">
        </div>

        <nav class="nav-links">

            <a routerLink="/home" routerLinkActive="active" class="nav-item">
                <mat-icon>home</mat-icon> Início
            </a>

            @if (perfilUsuario === HeaderPerfilEnum.ADMIN) {
            <a routerLink="/empresa/listar" routerLinkActive="active" class="nav-item">
                <mat-icon>business</mat-icon> Empresas
            </a>
            }

            @if (perfilUsuario === HeaderPerfilEnum.ADMIN || perfilUsuario === HeaderPerfilEnum.ADMIN_EMPRESA) {
            <a routerLink="/usuario/listar" routerLinkActive="active" class="nav-item">
                <mat-icon>people</mat-icon> Usuários
            </a>
            }

            @if (perfilUsuario === HeaderPerfilEnum.USUARIO) {
            <a routerLink="/chamado/listar" routerLinkActive="active" class="nav-item">
                <mat-icon>assignment</mat-icon> Meus Chamados
            </a>
            }

            @if (perfilUsuario === HeaderPerfilEnum.TECNICO_TI) {
            <a routerLink="/atendimento/listar" routerLinkActive="active" class="nav-item">
                <mat-icon>assignment_turned_in</mat-icon> Atendimento
            </a>
            }

            @if (perfilUsuario === HeaderPerfilEnum.ADMIN || perfilUsuario === HeaderPerfilEnum.ADMIN_EMPRESA ||
            perfilUsuario === HeaderPerfilEnum.TECNICO_TI) {
            <a routerLink="/relatorios" routerLinkActive="active" class="nav-item">
                <mat-icon>bar_chart</mat-icon> Relatórios
            </a>
            }

        </nav>

        <div class="user-actions">
            <div class="user-info">
                <span class="user-name">Olá, {{ nomeUsuario }}</span>
            </div>

            <button mat-icon-button [matMenuTriggerFor]="menu" class="avatar-btn">
                <div class="avatar-circle">{{ iniciais }}</div>
            </button>

            <mat-menu #menu="matMenu">
                <button mat-menu-item routerLink="usuario/alterar-meus-dados">
                    <mat-icon>person</mat-icon> Meus Dados
                </button>

                <button mat-menu-item routerLink="usuario/alterar-senha">
                    <mat-icon>lock</mat-icon> Alterar Senha
                </button>

                <button mat-menu-item (click)="logout()">
                    <mat-icon>exit_to_app</mat-icon> Sair
                </button>
            </mat-menu>

            <button mat-icon-button [matMenuTriggerFor]="notificacaoMenu" class="notification-btn">
                <mat-icon [matBadge]="unreadCount" matBadgeColor="warn" [matBadgeHidden]="unreadCount === 0">
                    notifications
                </mat-icon>
            </button>

            <mat-menu #notificacaoMenu="matMenu" xPosition="before" class="notification-menu-panel">
                <div class="notification-header">
                    <h3>Notificações</h3>
                    <button class="btn-mark-read" (click)="$event.stopPropagation()">Marcar todas como lidas</button>
                </div>

                <div class="notification-list">
                    <div *ngFor="let n of notificacoes" class="notification-item" [class.unread]="!n.lida">
                        <div class="notif-icon">
                            <mat-icon>{{ n.lida ? 'notifications_none' : 'mark_email_unread' }}</mat-icon>
                        </div>
                        <div class="notif-content">
                            <span class="notif-title">{{ n.titulo }}</span>
                            <span class="notif-msg">{{ n.mensagem }}</span>
                            <span class="notif-time">{{ n.tempo }}</span>
                        </div>
                        <div class="unread-dot" *ngIf="!n.lida"></div>
                    </div>

                    <div *ngIf="notificacoes.length === 0" class="empty-state">
                        <mat-icon>notifications_off</mat-icon>
                        <p>Nenhuma notificação nova</p>
                    </div>
                </div>

                <div class="notification-footer">
                    <button mat-button color="primary">Ver todas</button>
                </div>
            </mat-menu>

        </div>

    </div>
</header>
